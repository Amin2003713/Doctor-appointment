@page "/register"
@using AppointmentPlanner.Client.Services.Auth
@using AppointmentPlanner.Shared.Dtos
@inject AuthService Auth
@inject NavigationManager Nav

<MudPaper Class="pa-6 mx-auto mt-12" Style="max-width:420px" Elevation="8" dir="rtl">
    <MudText Typo="Typo.h5" Class="mb-4">ثبت‌نام</MudText>

    <MudTextField @bind-Value="_dto.FullName" Label="نام کامل" Required="true"/>
    <MudTextField @bind-Value="_dto.Email" Label="ایمیل" Required="true"/>
    <MudTextField @bind-Value="_dto.Password" Label="رمز عبور" InputType="InputType.Password" Required="true"/>
    <MudButton OnClick="DoRegister" Color="Color.Primary" Variant="Variant.Filled" Class="mt-4" FullWidth="true">
        ثبت‌نام
    </MudButton>

    @if (!string.IsNullOrEmpty(Message))
    {
        <MudAlert Severity="Severity.Error" Class="mt-3">@Message</MudAlert>
    }
</MudPaper>

@code {
    RegisterDto _dto { get; set; } = new();
    private string? Message { get; set; }

    async Task DoRegister()
    {
        var ok = await Auth.RegisterAsync(_dto);
        if (ok) Nav.NavigateTo("/login");
        else Message = "ثبت‌نام ناموفق بود!";
    }

}